= form_for @inspection do |f|
  - if @inspection.errors.any?
    #error_explanation
      %h2= "#{pluralize(@inspection.errors.count, "error")} prohibited this inspection from being saved:"
      %ul
        - @inspection.errors.full_messages.each do |msg|
          %li= msg

  .row
    .bottom-10 Let's fill in some contact info:
  .row
    .field.columns.small-12
      = f.label :permit_number
      = f.text_field :permit_number, required: true, placeholder: 'BRMD123456'
  .row
    .field.columns.small-12
      = f.label 'Name'
      = f.text_field :contact_name, required: true
  .row
    .field.columns.small-12
      = f.label 'Phone number'
      = f.text_field :contact_phone, required: true
  .row
    .field.columns.small-12
      = f.label 'Email'
      = f.text_field :contact_email
  .row
    .bottom-10 What is the inspection type?
    .field
      = f.hidden_field :inspection_type_id
    .field.columns.small-12
      - supercategories = InspectionType.pluck(:inspection_supercategory).uniq.map{|type| [type.titleize, type] }
      %select.inspection-supercategories{ name: 'supercategory' }
        %option
        = options_for_select(supercategories)
    .field.columns.small-12
      %select.inspection-categories{ name: 'category', style: "display:none;" }
        -# options are inserted here by JS
    .field.columns.small-12
      %select.inspection-names{ style: "display:none;" }
        -# options are inserted here by JS
    .columns.small-12
      .inspection-type-comments.bottom-10
  .row
    .bottom-10 For which date would you like to schedule your inspection?
    .field.columns.small-12
      %input#inspection_requested_for_date.datepicker{ type:'text', name:'inspection[requested_for_date]' }
      :javascript
        $('.datepicker').datepicker({
          minDate: #{Time.now.hour < 15 ? 1 : 2}, // cutoff to schedule next-day inspections is 3pm
          beforeShowDay: $.datepicker.noWeekends,
        });
      .row
        %small
          Inspections requested before 3pm PST are scheduled by default for the next business day. Inspections may also be scheduled for future days. No inspections are performed on weekends.
    .bottom-10 What time of day?
    .field.columns.small-12
      = f.select(:requested_for_time, options_for_select([['Anytime', nil], ['Morning', 'am'], ['Afternoon', 'pm']]))
  .row
    .bottom-10 Where will the inspection take place?
  .field
    = f.fields_for :address do |addr|
      .field.columns.small-12
        = addr.label :line_1
        = addr.text_field :line_1, required: true
      .field.columns.small-12
        = addr.label :line_2
        = addr.text_field :line_2
      .row
        .columns.small-8
          = addr.label :city
          = addr.hidden_field :city, value: 'Long Beach'
          %input{ type:'text', value:'Long Beach', disabled: true }
        .columns.small-4
          = addr.label :state
          = addr.hidden_field :state, value: 'CA'
          %input{ type:'text', value:'CA', disabled: true }
      .field.columns.small-12
        = addr.label :zip
        = addr.text_field :zip, required: true
  .row
    .bottom-10 Any other notes or instructions for when the inspector arrives?
    .field.columns.small-12
      = f.label :notes
      = f.text_field :notes
  .actions.columns.small-12
    %button.button.expanded{ type: 'submit' } Submit
